#!/usr/bin/env node

/**
 * Creates a simple test image for E2E testing
 * This script creates a test JPEG image without requiring external dependencies
 */

const fs = require('fs');
const path = require('path');

// Create a minimal valid JPEG file (1x1 pixel, black)
// JPEG header for a 1x1 black pixel image
const jpegData = Buffer.from([
  // JPEG SOI (Start of Image)
  0xFF, 0xD8,

  // JFIF APP0 marker
  0xFF, 0xE0, 0x00, 0x10, 0x4A, 0x46, 0x49, 0x46, 0x00, 0x01, 0x01, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00,

  // Quantization table
  0xFF, 0xDB, 0x00, 0x43, 0x00,
  0x03, 0x02, 0x02, 0x03, 0x02, 0x02, 0x03, 0x03,
  0x03, 0x03, 0x04, 0x03, 0x03, 0x04, 0x05, 0x08,
  0x05, 0x05, 0x04, 0x04, 0x05, 0x0A, 0x07, 0x07,
  0x06, 0x08, 0x0C, 0x0A, 0x0C, 0x0C, 0x0B, 0x0A,
  0x0B, 0x0B, 0x0D, 0x0E, 0x12, 0x10, 0x0D, 0x0E,
  0x11, 0x0E, 0x0B, 0x0B, 0x10, 0x16, 0x10, 0x11,
  0x13, 0x14, 0x15, 0x15, 0x15, 0x0C, 0x0F, 0x17,
  0x18, 0x16, 0x14, 0x18, 0x12, 0x14, 0x15, 0x14,

  // SOF0 (Start of Frame)
  0xFF, 0xC0, 0x00, 0x0B, 0x08, 0x00, 0x01, 0x00, 0x01, 0x01, 0x01, 0x11, 0x00,

  // DHT (Define Huffman Table)
  0xFF, 0xC4, 0x00, 0x14, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08,
  0xFF, 0xC4, 0x00, 0x14, 0x10, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

  // SOS (Start of Scan)
  0xFF, 0xDA, 0x00, 0x08, 0x01, 0x01, 0x00, 0x00, 0x3F, 0x00,

  // Image data (1x1 black pixel)
  0xD2, 0x7F,

  // EOI (End of Image)
  0xFF, 0xD9
]);

// For a more realistic test, let's create a larger image by repeating the pattern
// Create a simple 100x100 grayscale gradient image
function createGradientJPEG() {
  // This is a more complete JPEG with actual image data
  // For simplicity, we'll use the minimal JPEG and note that real E2E tests
  // may need actual photo images

  const outputPath = path.join(__dirname, 'sample-image.jpg');
  fs.writeFileSync(outputPath, jpegData);

  console.log(`Created test image: ${outputPath}`);
  console.log(`File size: ${jpegData.length} bytes`);
  console.log('Note: This is a minimal 1x1 JPEG for basic testing.');
  console.log('For comprehensive E2E tests, replace with a real photo (500KB-2MB).');
}

createGradientJPEG();
